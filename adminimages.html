<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Image Manager</title>
  <script src="https://cdn.jsdelivr.net/npm/pouchdb@7.3.1/dist/pouchdb.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .upload-section, .images-section {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .image-box {
      display: inline-block;
      margin: 10px;
      border: 1px solid #ccc;
      padding: 10px;
      background: #fff;
      border-radius: 8px;
    }
    .image-box img {
      max-width: 200px;
      display: block;
      margin-bottom: 10px;
    }
    .image-url {
      font-size: 12px;
      margin-bottom: 5px;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <h1>Admin Image Upload & Management</h1>  <div class="upload-section">
    <h2>Upload Image</h2>
    <input type="file" id="imageInput" accept="image/*" />
    <button onclick="uploadImage()">Upload</button>
    <p>Note: Keep image formats compatible (JPG, PNG, GIF).</p>
  </div>  <div class="images-section">
    <h2>Uploaded Images</h2>
    <div id="imagesContainer"></div>
  </div>  <script>
    const db = new PouchDB('macx_images');
    const remoteDB = new PouchDB('https://your-couchdb-server.com/macx_images'); // Change this URL to your CouchDB

    db.sync(remoteDB, {
      live: true,
      retry: true
    });

    function uploadImage() {
      const input = document.getElementById('imageInput');
      if (!input.files.length) return alert('No image selected.');

      const file = input.files[0];
      const reader = new FileReader();

      reader.onload = function () {
        const id = new Date().toISOString();
        db.put({
          _id: id,
          _attachments: {
            [file.name]: {
              content_type: file.type,
              data: reader.result.split(',')[1]
            }
          }
        }).then(() => {
          alert('Image uploaded successfully.');
          displayImages();
        }).catch(console.error);
      };

      reader.readAsDataURL(file);
    }

     function displayImages() {
  document.getElementById('imagesContainer').innerHTML = '';
  db.allDocs({ include_docs: true, attachments: true }).then(result => {
    result.rows.forEach(row => {
      const doc = row.doc;
      for (let name in doc._attachments) {
        const imgUrl = `https://your-couchdb-server.com/macx_images/${doc._id}/${encodeURIComponent(name)}`;
        const div = document.createElement('div');
        div.className = 'image-box';
        div.innerHTML = `
          <img src="${imgUrl}" alt="${name}" />
          <div class="image-url"><a href="${imgUrl}" target="_blank">${imgUrl}</a></div>
          <button onclick="deleteImage('${doc._id}', '${doc._rev}')">Delete</button>
        `;
        document.getElementById('imagesContainer').appendChild(div);
      }
    });
  });
}

    function deleteImage(id, rev) {
      db.remove(id, rev).then(() => {
        alert('Image deleted.');
        displayImages();
      });
    }

    displayImages();
  </script></body>
</html>
